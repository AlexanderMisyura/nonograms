(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var i=n.getElementsByTagName("script");if(i.length)for(var s=i.length-1;s>-1&&(!t||!/^http(s?):/.test(t));)t=i[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();class t{constructor(e){this.generate(e)}generate({tagName:e,className:t="",attributes:n={},children:i=[]}){this.element=document.createElement(e),this.setCssClassNames(t),this.setAttributes(n),this.appendChildren(i)}setCssClassNames(e){this.element.className=e}setAttributes(e){Object.keys(e).forEach((t=>this.element.setAttribute(t,e[t])))}appendChildren(e){this.element.append(...e.map((e=>e instanceof t?e.getHTMLElement():e)))}getHTMLElement(){return this.element}}class n{constructor(e){this.generator=this.generateView(e)}generateView(e){return new t(e)}getElement(){return this.generator.getHTMLElement()}}const i=e.p+"assets/logo-long.png";class s extends n{constructor(e){super({tagName:"a",className:"navbar-burger"}),this.setupView(e)}toggleMenu(e){this.getElement().classList.toggle("is-active"),e.classList.toggle("is-active")}setupView(e){this.generator.appendChildren(Array.from({length:3},(()=>new t({tagName:"span"})))),this.getElement().addEventListener("click",(()=>this.toggleMenu(e)))}}class a extends n{constructor({textContent:e="",className:t,iconClassNames:n=null,callback:i=null}){super({tagName:"button",className:t}),this.iconClasses=n,this.setupView({textContent:e,iconClassNames:n,callback:i})}changeIcon(){this.icon&&(this.icon.className=this.iconClasses.inactive,[this.iconClasses.active,this.iconClasses.inactive]=[this.iconClasses.inactive,this.iconClasses.active])}setCallback(e){this.getElement().addEventListener("click",e)}setupView({textContent:e,iconClassNames:n,callback:i}){if(i&&this.setCallback(i),e&&(this.getElement().textContent=e),n){const e=new t({tagName:"i",className:this.iconClasses.active});this.icon=e.getHTMLElement(),this.generator.appendChildren([this.icon]),this.getElement().addEventListener("click",(()=>this.changeIcon())),this.getElement().addEventListener("mouseenter",(()=>this.changeIcon())),this.getElement().addEventListener("mouseleave",(()=>this.changeIcon()))}}}class o extends n{constructor(e){super({tagName:"div",className:"buttons is-flex is-justify-content-center"}),this.setupView(e)}setupView(e){this.generator.appendChildren(e.map((e=>new a(e).getElement())))}}function l(){document.body.classList.toggle("dark-theme"),document.querySelectorAll(".button").forEach((e=>{e.classList.toggle("is-white"),e.classList.toggle("is-dark")}))}const r="button is-white is-medium pl-3 pr-3 m-0",c="button is-white is-large m-0 has-width-50";class m extends n{constructor(e){super({tagName:"nav",className:"navbar is-align-items-center"}),this.main=e,this.audio=e.audio,this.nonogramSection=e.nonogramSection,this.nonogramField=e.nonogramSection.nonogramField,this.setupView(this.main)}setupView(){const e=new t({tagName:"div",className:"navbar-end"}),n=new t({tagName:"div",className:"navbar-menu is-shadowless"});n.appendChildren([e]);const a=[{textContent:"Reset Game",className:r,callback:this.nonogramField.resetField.bind(this.nonogramField)},{textContent:"Save Game",className:r,callback:this.nonogramSection.saveNonogram.bind(this.nonogramSection)},{textContent:"Continue Last Game",className:r,callback:this.nonogramSection.continueNonogram.bind(this.nonogramSection)},{textContent:"Change Nonogram",className:r,callback:this.main.showNonograms.bind(this.main)},{textContent:"Results",className:r,callback:this.main.showResults.bind(this.main)},{textContent:"Random Game",className:r,callback:this.nonogramSection.setupRandomNonogram.bind(this.nonogramSection)}],m=[{className:c,iconClassNames:{active:"fa-solid fa-volume-high",inactive:"fa-solid fa-volume-xmark"},callback:this.audio.toggleMuteAudio.bind(this.audio)},{className:c,iconClassNames:{active:"fa-solid fa-sun",inactive:"fa-solid fa-moon"},callback:l}],h=new o(a),d=new o(m);e.appendChildren([h.getElement(),d.getElement()]);const g=new t({tagName:"div",className:"navbar-brand is-align-items-center"}),u=new t({tagName:"img",className:"image has-ratio",attributes:{src:i,alt:"logo",height:"32"}}),p=new s(n.getHTMLElement());g.appendChildren([u,p.getElement()]),this.generator.appendChildren([g,n])}}class h extends n{constructor(e){super({tagName:"header",className:"container box mt-1"}),this.setupView(e)}setupView(e){const t=new m(e).getElement();this.generator.appendChildren([t])}}class d extends n{constructor(e=0){super({tagName:"div",className:"box is-size-2 is-family-monospace mb-0 mr-6"}),this.time=e,this.timerId=null,this.setupView()}startTimer(){this.timerId||(this.timerId=setInterval((()=>{this.time++,this.updateDisplay()}),1e3))}pauseTimer(){this.timerId&&(clearInterval(this.timerId),this.timerId=null)}resetTimer(e=0){this.pauseTimer(),this.time=e,this.updateDisplay()}getTime(){return this.time}getTimeFormatted(){const e=Math.floor(this.time/60),t=this.time%60;return`${e}:${t<10?"0":""}${t}`}updateDisplay(){this.getElement().textContent=this.getTimeFormatted()}setupView(){this.getElement().textContent="0:00"}}const g=e.p+"assets/click.wav",u=e.p+"assets/context_menu.wav",p=e.p+"assets/win.wav",f=e.p+"assets/clack.wav";class w{constructor(){this.clickAudio=new Audio(g),this.contextMenuAudio=new Audio(u),this.winAudio=new Audio(p),this.clackAudio=new Audio(f)}async click(){await this.stopAudio(),this.clickAudio.play()}async contextMenu(){await this.stopAudio(),this.contextMenuAudio.play()}async clack(){await this.stopAudio(),this.clackAudio.play()}async win(){await this.stopAudio(),this.winAudio.play()}async stopAudio(){Object.getOwnPropertyNames(this).forEach((e=>{4===this[e].readyState&&(this[e].pause(),this[e].currentTime=0)}))}async toggleMuteAudio(){Object.getOwnPropertyNames(this).forEach((e=>{this[e].muted=!this[e].muted}))}}function N(e,t,n){for(;t>e.length;)e.unshift(n);return e}function C(e){const t=[];return e.forEach(((e,n)=>{t[n]=[],e.forEach(((e,i)=>{t[n][i]=0}))})),t}class v extends n{constructor(e,t,n,i){super({tagName:"div",className:"nonogram"}),this.nonogram=e,this.setupView({nonogram:this.nonogram}),this.audio=i,this.modal=t,this.timer=n,this.isShown=!1,this.userSolution=C(e.solution)}changeOwnNonogram(e,t){this.nonogram=e,this.userSolution=t||C(e.solution)}setupView({nonogram:e,load:n=!1}){const{solution:i}=e;i.forEach(((e,i)=>{const s=new t({tagName:"div",className:"nonogram__row"});e.forEach(((e,a)=>{const o=new t({tagName:"div",className:"nonogram__cell",attributes:{id:`cell-${i}-${a}`}});if(n){const t={1:"check-filled",2:"check-empty"};o.getHTMLElement().classList.add(t[e])}const l=new t({tagName:"span",className:"nonogram__value"});o.appendChildren([l]),s.appendChildren([o])})),this.generator.appendChildren([s])})),this.setCallback()}resetField(){this.isShown=!1;const{solution:e}=this.nonogram,t=this.getElement();for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const e=t.querySelector(`#cell-${n}-${i}`);e.classList.remove("check-filled"),e.classList.remove("check-empty")}this.timer.resetTimer(),this.removeCallback(),this.userSolution=C(this.nonogram.solution),this.setCallback()}revealSolution(){this.isShown=!0,this.timer.resetTimer();const{solution:e}=this.nonogram,t=this.getElement();for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const s=t.querySelector(`#cell-${n}-${i}`);(1===e[n][i]&&!s.classList.contains("check-filled")||1!==e[n][i]&&s.classList.contains("check-filled"))&&this.paintCell(s)}this.removeCallback()}paintCell(e){e.classList.remove("check-empty"),e.classList.toggle("check-filled")}markCell(e){e.classList.remove("check-filled"),e.classList.toggle("check-empty")}checkWin(){for(let e=0;e<this.nonogram.solution.length;e++)for(let t=0;t<this.nonogram.solution[e].length;t++){const n=this.userSolution[e][t],i=this.nonogram.solution[e][t];if((1===n||1===i)&&n!==i)return}this.isShown=!0,this.timer.pauseTimer(),this.openModal(),this.writeStorage(),this.audio.win(),this.removeCallback(),this.userSolution=C(this.userSolution)}writeStorage(){const e={name:this.nonogram.name,difficulty:this.nonogram.difficulty,time:this.timer.getTime(),formattedTime:this.timer.getTimeFormatted()};let t=JSON.parse(localStorage.getItem("wins"));t?t.unshift(e):t=[e],t=t.slice(0,5),localStorage.setItem("wins",JSON.stringify(t))}fillUserSolution({cell:e,value:t}){const{clickRow:n,clickCell:i}=e;this.userSolution[n][i]=t}getCellValue(e){return e.classList.contains("check-filled")?(this.audio.click(),1):e.classList.contains("check-empty")?(this.audio.contextMenu(),2):(this.audio.clack(),0)}openModal(){const e=new t({tagName:"div",className:"box is-size-1 has-text-centered is-family-monospace"});e.getHTMLElement().textContent=`Great! You have solved the nonogram in ${this.timer.getTime()} seconds!`,this.modal.setContent(e),this.modal.open()}closeModal(){this.modal.close()}clickHandler(e){const t=e.target.closest(".nonogram__cell");if(!t)return;this.timer.startTimer(),this.paintCell(t);const[,n,i]=t.id.split("-"),s=this.getCellValue(t);this.fillUserSolution({cell:{clickRow:n,clickCell:i},value:s}),this.checkWin()}contextMenuHandler(e){e.preventDefault();const t=e.target.closest(".nonogram__cell");if(!t)return;this.timer.startTimer(),this.markCell(t);const[,n,i]=t.id.split("-"),s=this.getCellValue(t);this.fillUserSolution({cell:{clickRow:n,clickCell:i},value:s}),this.checkWin()}setCallback(){this.clickHandler=this.clickHandler.bind(this),this.contextMenuHandler=this.contextMenuHandler.bind(this),this.getElement().addEventListener("click",this.clickHandler),this.getElement().addEventListener("contextmenu",this.contextMenuHandler)}removeCallback(){this.getElement().removeEventListener("click",this.clickHandler),this.getElement().removeEventListener("contextmenu",this.contextMenuHandler)}}class E extends n{constructor({solution:e,top:t=!0}){super({tagName:"div",className:`hint hint-${t?"top":"side"} is-family-monospace is-size-4`}),this.setupView({solution:e,top:t})}setupView({solution:e,top:n}){let i;i=n?function(e){let t=[],n=0;for(let i=0;i<e[0].length;i++){t[i]=[];let s=0;for(let a=0;a<e.length;a++){const o=e[a][i];1===o&&s++,1===o&&a!==e.length-1||0===s||(t[i].push(s),s=0),a===e.length-1&&n<t[i].length&&(n=t[i].length)}}return t=t.map((e=>N(e,n,0))),t=t[0].map(((e,n)=>t.map((e=>e[n])))),t}(e):function(e){let t=[],n=0;return e.forEach(((e,i)=>{t[i]=[];let s=0;e.forEach(((a,o)=>{1===a&&s++,1===a&&o!==e.length-1||0===s||(t[i].push(s),s=0),o===e.length-1&&n<t[i].length&&(n=t[i].length)}))})),t=t.map((e=>N(e,n,0))),t}(e),i.forEach((e=>{const n=new t({tagName:"div",className:"hint__row"});e.forEach((e=>{const i=new t({tagName:"div",className:"hint__cell"});if(0!==e){const n=new t({tagName:"span",className:"hint__value"});n.getHTMLElement().textContent=e,i.appendChildren([n])}n.appendChildren([i])})),this.generator.appendChildren([n])}))}}const b=[{name:"Smile",id:0,difficulty:"easy",solution:[[0,1,0,1,0],[0,1,0,1,0],[0,0,1,0,0],[1,0,0,0,1],[0,1,1,1,0]]},{name:"Duck",id:1,difficulty:"easy",solution:[[0,1,1,0,0],[1,1,1,0,1],[0,1,1,1,1],[0,1,1,1,1],[0,0,1,0,0]]},{name:"House",id:2,difficulty:"easy",solution:[[0,0,1,0,0],[0,1,1,1,0],[1,1,1,1,1],[0,1,0,1,0],[0,1,1,1,0]]},{name:"Flower",id:3,difficulty:"easy",solution:[[0,1,0,1,0],[1,0,1,0,1],[0,1,1,1,0],[0,0,1,0,0],[0,0,1,0,0]]},{name:"Trident",id:4,difficulty:"easy",solution:[[1,0,1,0,1],[1,0,1,0,1],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]]},{name:"Bunny",id:5,difficulty:"medium",solution:[[0,0,0,1,0,1,0,0,0,0],[0,0,1,0,1,0,1,0,0,0],[0,0,1,0,1,0,1,0,0,0],[0,1,0,0,0,0,1,0,0,1],[1,0,1,0,0,0,0,1,1,0],[1,0,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,0],[0,1,1,1,0,0,0,0,1,0],[0,0,1,0,0,1,1,0,1,0],[0,0,1,1,1,0,1,1,1,0]]},{name:"Guy",id:6,difficulty:"medium",solution:[[0,0,0,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,0],[0,1,1,1,1,0,0,1,0,0],[0,1,0,0,0,0,0,0,1,0],[1,1,0,1,0,1,0,0,1,0],[1,0,0,0,0,0,0,1,0,0],[0,1,0,0,1,0,0,1,0,0],[0,0,1,0,1,0,1,0,0,0],[0,0,0,1,0,1,0,0,0,0],[0,0,0,0,1,0,0,0,0,0]]},{name:"Skull",id:7,difficulty:"medium",solution:[[1,1,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[0,1,1,0,0,0,0,1,1,0],[0,1,1,1,0,0,1,1,1,0],[0,0,1,0,0,0,0,1,0,0],[1,0,0,0,1,1,0,0,0,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,1,0,0,1,0,1,1]]},{name:"Yin and Yang",id:8,difficulty:"medium",solution:[[0,0,0,1,1,1,1,0,0,0],[0,0,1,1,1,0,0,1,0,0],[0,1,1,1,0,0,0,0,1,0],[1,1,1,1,0,1,0,0,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1],[0,1,1,1,0,1,0,0,1,0],[0,0,1,1,1,1,0,1,0,0],[0,0,0,1,1,1,1,0,0,0]]},{name:"Invader",id:9,difficulty:"medium",solution:[[0,0,1,0,0,0,0,1,0,0],[0,0,0,1,0,0,1,0,0,0],[0,0,1,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,1,0,0],[0,1,1,0,1,1,0,1,1,0],[1,1,1,1,1,1,1,1,1,1],[1,0,1,1,1,1,1,1,0,1],[1,0,1,1,1,1,1,1,0,1],[0,0,1,0,0,0,0,1,0,0],[0,0,0,1,0,0,1,0,0,0]]},{name:"Bomb",id:10,difficulty:"hard",solution:[[0,0,0,0,0,0,0,0,1,1,1,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,1,0,0,1],[0,0,0,0,0,0,1,1,1,0,0,0,1,1,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,1],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,1,1,1,1,1,1,1,0,1,0,0,0],[0,0,1,1,1,1,1,1,1,1,0,0,1,0,0],[0,0,1,1,1,1,1,1,1,1,1,0,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,0,0,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0]]},{name:"Packman",id:11,difficulty:"hard",solution:[[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0],[0,0,0,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,0,0,1,1,1,1,0],[0,1,1,1,1,1,1,1,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,0,0,0],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0],[1,1,1,1,1,1,1,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,0,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,0,0,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"Hot Cup",id:12,difficulty:"hard",solution:[[0,0,0,1,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,1,0,1,0,0,0,1,0,0,0,0],[0,0,0,1,0,0,1,0,0,0,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,0,1,1,1,1,1,1,1,1,1,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,1,1,1,1,1,1,1,1,1,0,0,0,0]]},{name:"Super Mushroom",id:13,difficulty:"hard",solution:[[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0],[0,0,0,1,1,1,1,1,1,0,1,1,0,0,0],[0,0,1,0,0,1,1,1,1,0,0,0,1,0,0],[0,1,0,0,1,1,1,1,1,1,0,0,0,1,0],[0,1,0,1,1,0,0,0,1,1,1,1,1,1,0],[1,1,1,1,0,0,0,0,0,1,1,0,0,1,1],[1,0,1,1,0,0,0,0,0,1,0,0,0,0,1],[1,0,0,1,1,0,0,0,1,1,0,0,0,0,1],[1,0,0,1,1,1,1,1,1,1,1,0,0,1,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,0,0,1,0,1,0,0,1,1,1,0],[0,0,1,0,0,0,1,0,1,0,0,0,1,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0]]},{name:"Batman Logo",id:14,difficulty:"hard",solution:[[0,0,0,1,0,0,0,0,0,0,0,1,0,0,0],[0,0,1,1,0,0,1,0,1,0,0,1,1,0,0],[0,0,1,0,0,0,1,1,1,0,0,0,1,0,0],[0,1,1,0,0,0,1,1,1,0,0,0,1,1,0],[1,1,1,1,0,1,1,1,1,1,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],[0,1,1,0,1,0,1,1,1,0,1,0,1,1,0],[0,0,1,0,0,0,0,1,0,0,0,0,1,0,0],[0,0,1,1,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,0,0,0]]}];class k extends n{constructor(e,t,n){super({tagName:"section",className:"section box nonogram-section"}),this.timer=t,this.audio=n,this.modal=e,this.nonogramField=null,this.nonogramTopHint=null,this.nonogramSideHint=null,[this.nonogram]=b,this.setupView(this.nonogram,this.modal,this.timer,this.audio)}getAllNonograms(){return b}saveNonogram(){if(this.nonogramField.isShown)return;const e=this.timer.getTime(),t=this.nonogramField.userSolution,{name:n,id:i}=this.nonogram;localStorage.setItem("nonogramSave",JSON.stringify({time:e,solution:t,name:n,id:i}))}continueNonogram(){const e=JSON.parse(localStorage.getItem("nonogramSave"));if(!e)return;const{time:t,solution:n,name:i,id:s}=e,a=b.find((e=>e.id===s));this.setNonogram(a),this.timer.resetTimer(t),this.removeNonogram(),this.nonogramField.isShown=!1,this.nonogramField.changeOwnNonogram(this.nonogram,n),this.nonogramField.removeCallback(),this.nonogramField.setupView({nonogram:{solution:n,name:i,id:s},load:!0}),this.nonogramTopHint.setupView({solution:this.nonogram.solution,top:!0}),this.nonogramSideHint.setupView({solution:this.nonogram.solution,top:!1})}removeNonogram(){const e=this.nonogramField.getElement();for(;e.firstElementChild;)e.firstElementChild.remove();const t=this.nonogramTopHint.getElement();for(;t.firstElementChild;)t.firstElementChild.remove();const n=this.nonogramSideHint.getElement();for(;n.firstElementChild;)n.firstElementChild.remove()}setupRandomNonogram(){const e=(0,t=b.length-1,Math.floor(Math.random()*(t-0+1))+0);var t;this.setNonogram(b[e]),this.resetSection()}setupNonogramByIndex(e){this.setNonogram(b[e]),this.resetSection()}setNonogram(e){this.nonogram=e}resetSection(){this.timer.resetTimer(),this.removeNonogram(),this.nonogramField.changeOwnNonogram(this.nonogram),this.nonogramField.removeCallback(),this.nonogramField.isShown=!1,this.nonogramField.setupView({nonogram:this.nonogram}),this.nonogramTopHint.setupView({solution:this.nonogram.solution,top:!0}),this.nonogramSideHint.setupView({solution:this.nonogram.solution,top:!1})}setupView(e,t,n,i){const{solution:s}=e;this.nonogramTopHint=new E({solution:s,top:!0}),this.nonogramTopHint.getElement().classList.add("hint-top"),this.nonogramSideHint=new E({solution:s,top:!1}),this.nonogramSideHint.getElement().classList.add("hint-side"),this.nonogramField=new v(e,t,n,i),this.generator.appendChildren([this.nonogramTopHint.getElement(),this.nonogramField.getElement(),this.nonogramSideHint.getElement()])}}class y extends n{constructor(e){super({tagName:"div",className:"modal"}),this.contentGenerator=e,this.containerGenerator=null,this.background=null,this.closeButton=null,this.setupView(this.content)}open(){this.generator.getHTMLElement().classList.add("is-active")}close(){this.generator.getHTMLElement().classList.remove("is-active")}clickHandler(){this.close()}setCallback(){this.clickHandler=this.clickHandler.bind(this),this.background.getHTMLElement().addEventListener("click",this.clickHandler),this.closeButton.getHTMLElement().addEventListener("click",this.clickHandler)}setupView(e){const n=new t({tagName:"div",className:"modal-background"});this.background=n;const i=new t({tagName:"div",className:"modal-content"});this.containerGenerator=i,e&&i.appendChildren([e]);const s=new t({tagName:"button",className:"modal-close is-large"});this.closeButton=s,this.generator.appendChildren([n,i,s]),this.setCallback()}setContent(e){this.contentGenerator=e;const t=this.containerGenerator.getHTMLElement();for(;t.firstElementChild;)t.firstElementChild.remove();this.containerGenerator.appendChildren([this.contentGenerator])}}class S extends n{constructor(){super({tagName:"main",className:"container is-flex is-justify-content-center is-align-items-center is-flex-direction-column"}),this.timer=null,this.nonogramSection=null,this.setupView()}setupView(){this.audio=new w,this.timer=new d,this.modal=new y,this.nonogramSection=new k(this.modal,this.timer,this.audio);const e=new t({tagName:"section",className:"section is-flex is-align-items-center"}),{nonogramField:n}=this.nonogramSection,i=new a({textContent:"Solution",className:"button is-white is-large m-0",callback:n.revealSolution.bind(n)});e.appendChildren([this.timer.getElement(),i.getElement()]),this.generator.appendChildren([e,this.nonogramSection.getElement(),this.modal.getElement()])}showResults(){let e=JSON.parse(localStorage.getItem("wins"));if(!e)return;const n=new t({tagName:"div",className:"box is-flex is-justify-content-center"}),i=new t({tagName:"table",className:"table is-striped is-family-monospace"});n.appendChildren([i]);const s=new t({tagName:"thead"}),a=new t({tagName:"tr"});s.appendChildren([a]);const o=["Pos","Name","Difficulty","Time"].map((e=>{const n=new t({tagName:"th",className:"is-size-3 has-text-weight-semibold"});return n.getHTMLElement().textContent=e,n}));a.appendChildren(o);const l=new t({tagName:"tbody"});e=e.toSorted(((e,t)=>e.time-t.time)),e.forEach(((e,n)=>{const i=new t({tagName:"tr"}),{name:s,difficulty:a,formattedTime:o}=e,r=new t({tagName:"td",className:"is-size-3"});r.getHTMLElement().textContent=n+1;const c=new t({tagName:"td",className:"is-size-3"});c.getHTMLElement().textContent=s;const m=new t({tagName:"td",className:"is-size-3"});m.getHTMLElement().textContent=a;const h=new t({tagName:"td",className:"is-size-3"});h.getHTMLElement().textContent=o,i.appendChildren([r,c,m,h]),l.appendChildren([i])})),i.appendChildren([s,l]),this.modal.setContent(n),this.modal.open()}showNonograms(){const e=new t({tagName:"div",className:"box is-flex is-justify-content-center"}),n=this.nonogramSection.getAllNonograms(),i=[n.filter((e=>"easy"===e.difficulty)),n.filter((e=>"medium"===e.difficulty)),n.filter((e=>"hard"===e.difficulty))];i.forEach(((n,s)=>{const a=new t({tagName:"table",className:"table is-size-3 is-striped is-hoverable is-family-monospace"});e.appendChildren([a]);const o=new t({tagName:"thead"}),l=new t({tagName:"tr"});o.appendChildren([l]);const r=new t({tagName:"th"});l.appendChildren([r]),r.getHTMLElement().textContent=n[0].difficulty;const c=new t({tagName:"tbody"});a.appendChildren([o,c]),s===i.length-1&&a.getHTMLElement().classList.add("mb-5"),n.forEach((n=>{const i=new t({tagName:"tr"}),s=new t({tagName:"td",className:"is-clickable",attributes:{"data-id":n.id}});s.getHTMLElement().textContent=n.name,i.appendChildren([s]),c.appendChildren([i]),c.getHTMLElement().addEventListener("click",this.changeNonogramHandler.bind(this)),this.modal.setContent(e),this.modal.open()}))}))}changeNonogramHandler(e){const t=e.target.closest("td"),{id:n}=t.dataset;this.nonogramSection.setupNonogramByIndex(n),this.modal.close()}}new class{constructor(){this.renderPage()}renderPage(){const e=new S,t=new h(e);document.body.append(t.getElement(),e.getElement())}}})();